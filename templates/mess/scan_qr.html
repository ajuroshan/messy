{% extends 'base.html' %}

{% block title %}Home{% endblock %}

{% block content %}
    <h1>Scan QR Code to Mark Attendance</h1>
    <div id="qr-reader" style="width:500px"></div>
    <div id="qr-reader-results"></div>

    <form id="qr-form" method="POST" action="{% url 'mark_attendance' %}">
        {% csrf_token %}
        <input type="hidden" name="qr_code_data" id="qr_code_data">
    </form>

    <script>
        function onScanSuccess(qrMessage) {
            document.getElementById('qr_code_data').value = qrMessage;
            document.getElementById('qr-form').submit();
        }

        function onScanError(errorMessage) {
            // handle scan error
        }

        let html5QrcodeScanner = new Html5QrcodeScanner(
            "qr-reader", { fps: 5, qrbox: 250 });
        html5QrcodeScanner.render(onScanSuccess, onScanError);
    </script>
{% endblock %}